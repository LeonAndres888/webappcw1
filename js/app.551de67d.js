(function(){"use strict";var t={6490:function(t,e,r){var o=r(5130),s=r(6768);const n={id:"app"};function a(t,e,r,o,a,i){const c=(0,s.g2)("parent-component"),u=(0,s.g2)("lesson-component"),l=(0,s.g2)("checkout-component");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.bF)(c,{sitename:a.sitename,cartItemCount:i.cartItemCount,onToggleCart:i.toggleCart},null,8,["sitename","cartItemCount","onToggleCart"]),a.showProduct?((0,s.uX)(),(0,s.Wv)(u,{key:0,lessons:i.sortedProducts,onAddToCart:i.addItemToCart},null,8,["lessons","onAddToCart"])):((0,s.uX)(),(0,s.Wv)(l,{key:1,cart:a.cart,onRemoveFromCart:i.removeItemFromCart},null,8,["cart","onRemoveFromCart"]))])}r(4114);var i=r(4232);const c={id:"app"},u={id:"titlename"};function l(t,e,r,o,n,a){const l=(0,s.g2)("lesson-component"),d=(0,s.g2)("checkout-component");return(0,s.uX)(),(0,s.CE)("div",c,[(0,s.Lk)("header",null,[(0,s.Lk)("h1",u,(0,i.v_)(n.sitename),1),(0,s.Lk)("button",{id:"cartBtn",onClick:e[0]||(e[0]=(...t)=>a.toggleCart&&a.toggleCart(...t))}," 🛒 Cart ("+(0,i.v_)(a.cartItemCount)+") ",1)]),(0,s.Lk)("main",null,[n.showProduct?((0,s.uX)(),(0,s.Wv)(l,{key:0,lessons:n.products,searchLesson:n.searchLesson,sortAttribute:n.sortAttribute,sortOrder:n.sortOrder,onAddToCart:t.addItemToCart,"onUpdate:searchLesson":t.updateSearchLesson,"onUpdate:sortAttribute":t.updateSortAttribute,onUpdateSortOrder:a.updateSortOrder},null,8,["lessons","searchLesson","sortAttribute","sortOrder","onAddToCart","onUpdate:searchLesson","onUpdate:sortAttribute","onUpdateSortOrder"])):((0,s.uX)(),(0,s.Wv)(d,{key:1,cart:n.cart,onRemoveFromCart:t.removeItemFromCart},null,8,["cart","onRemoveFromCart"]))])])}const d=t=>((0,s.Qi)("data-v-8f422066"),t=t(),(0,s.jt)(),t),h={class:"search-sort-container"},p=d((()=>(0,s.Lk)("option",{value:"title"},"Subject",-1))),m=d((()=>(0,s.Lk)("option",{value:"location"},"Location",-1))),b=d((()=>(0,s.Lk)("option",{value:"price"},"Price",-1))),v=d((()=>(0,s.Lk)("option",{value:"availableInventory"},"Spaces",-1))),f=[p,m,b,v],k=["src","alt"],C=["onClick","disabled"],g={key:0,class:"sold-out"};function L(t,e,r,n,a,c){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",h,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>a.localSearchLesson=t),onInput:e[1]||(e[1]=(...t)=>c.updateSearchLesson&&c.updateSearchLesson(...t)),placeholder:"Search lessons...",class:"search-bar"},null,544),[[o.Jo,a.localSearchLesson]]),(0,s.Lk)("button",{onClick:e[2]||(e[2]=t=>c.updateSortOrder("ascending")),class:"sort-button asc-button"}," Ascending "),(0,s.Lk)("button",{onClick:e[3]||(e[3]=t=>c.updateSortOrder("descending")),class:"sort-button dsc-button"}," Descending "),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>a.localSortAttribute=t),onChange:e[5]||(e[5]=(...t)=>c.updateSortAttribute&&c.updateSortAttribute(...t)),class:"dropDown"},f,544),[[o.u1,a.localSortAttribute]])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.sortedAndFilteredProducts,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"product-card"},[(0,s.Lk)("figure",null,[(0,s.Lk)("img",{src:e.image,alt:e.title},null,8,k)]),(0,s.Lk)("h2",null,(0,i.v_)(e.title),1),(0,s.Lk)("p",null,"Location: "+(0,i.v_)(e.location),1),(0,s.Lk)("p",null,"Price: £"+(0,i.v_)(e.price),1),(0,s.Lk)("p",null,"Spaces: "+(0,i.v_)(e.availableInventory),1),(0,s.Lk)("button",{onClick:r=>t.$emit("add-item-to-cart",e),disabled:0===e.availableInventory,class:"add-to-cart-button"}," Add to Cart ",8,C),0===e.availableInventory?((0,s.uX)(),(0,s.CE)("p",g,"Sold Out")):(0,s.Q3)("",!0)])))),128))])}var S={props:["products","searchLesson","sortAttribute","sortOrder"],data(){return{localSearchLesson:this.searchLesson,localSortAttribute:this.sortAttribute}},computed:{sortedAndFilteredProducts(){const t=this.localSearchLesson.trim().toLowerCase(),e=this.products.filter((e=>e.title.toLowerCase().includes(t)||e.location.toLowerCase().includes(t))),r="ascending"===this.sortOrder?1:-1;return e.slice().sort(((t,e)=>"price"===this.localSortAttribute||"availableInventory"===this.localSortAttribute?(t[this.localSortAttribute]-e[this.localSortAttribute])*r:t[this.localSortAttribute].localeCompare(e[this.localSortAttribute])*r))}},methods:{updateSearchLesson(t){this.localSearchLesson=t.target.value,this.$emit("update:searchLesson",this.localSearchLesson)},updateSortAttribute(t){this.localSortAttribute=t.target.value,this.$emit("update:sortAttribute",this.localSortAttribute)},updateSortOrder(t){this.$emit("update-sort-order",t)}}},y=r(1241);const A=(0,y.A)(S,[["render",L],["__scopeId","data-v-8f422066"]]);var O=A;const I=t=>((0,s.Qi)("data-v-016c0271"),t=t(),(0,s.jt)(),t),w={class:"checkout-container"},P=I((()=>(0,s.Lk)("h1",null,"Shopping Cart",-1))),T={key:0},E={class:"cart-list"},_=["onClick"],j=["disabled"],X={key:0,class:"thank-you-message"},q={key:1,class:"empty-cart-message"};function N(t,e,r,n,a,c){return(0,s.uX)(),(0,s.CE)("div",w,[P,r.cart.length>0?((0,s.uX)(),(0,s.CE)("div",T,[(0,s.Lk)("ul",E,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.cart,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"cart-item"},[(0,s.Lk)("span",null,(0,i.v_)(e.title)+" - "+(0,i.v_)(e.location)+" - £"+(0,i.v_)(e.price),1),(0,s.Lk)("button",{class:"remove-btn",onClick:r=>t.$emit("remove-item",e)}," Remove ",8,_)])))),128))]),(0,s.Lk)("form",{class:"checkout-form",onSubmit:e[2]||(e[2]=(0,o.D$)(((...t)=>c.checkOut&&c.checkOut(...t)),["prevent"]))},[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>a.custName=t),placeholder:"Name",required:""},null,512),[[o.Jo,a.custName]]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>a.custPhone=t),placeholder:"Phone number",required:""},null,512),[[o.Jo,a.custPhone]]),(0,s.Lk)("button",{type:"submit",class:"checkout-btn",disabled:!r.validCheckout}," Checkout ",8,j)],32),r.orderSubmitted?((0,s.uX)(),(0,s.CE)("p",X," Thank you for your order! ")):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",q,"Your cart is empty."))])}var F={props:{cart:Array,validCheckout:Boolean,orderSubmitted:Boolean},data(){return{custName:"",custPhone:""}},methods:{checkOut(){this.$emit("submit-order",{name:this.custName,phone:this.custPhone})}}};const U=(0,y.A)(F,[["render",N],["__scopeId","data-v-016c0271"]]);var $=U,x={components:{LessonComponent:O,CheckoutComponent:$},data(){return{sitename:"👨‍🎓 STUDY SESSION STORE 👩‍🎓",showProduct:!0,products:[],cart:[],searchLesson:"",sortAttribute:"title",sortOrder:"",custName:"",custPhone:"",orderSubmitted:!1}},computed:{cartItemCount(){return this.cart.reduce(((t,e)=>t+e.quantity),0)},validCheckout(){const t=/^[A-Za-z\s]+$/,e=/^[0-9()-]+$/;return t.test(this.custName)&&e.test(this.custPhone)},sortedProducts(){let t="ascending"===this.sortOrder?1:-1;return this.filteredProducts.slice().sort(((e,r)=>"price"===this.sortAttribute||"availableInventory"===this.sortAttribute?(e[this.sortAttribute]-r[this.sortAttribute])*t:e[this.sortAttribute].localeCompare(r[this.sortAttribute])*t))}},methods:{fetchLessons(){fetch("https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/lessons").then((t=>t.json())).then((t=>{this.products=t})).catch((t=>{console.error("Error fetching lessons:",t)}))},submitOrder(){const t={name:this.custName,phoneNumber:this.custPhone,items:this.cart.map((t=>({lessonId:t._id,quantity:t.quantity})))};console.log("Order items before submitting:",t.items),fetch("https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})).then((e=>(this.orderSubmitted=!0,console.log("Order submitted:",e),this.updateLessonSpaces(t.items,!0)))).then((()=>{this.fetchLessons()})).catch((t=>{console.error("Error submitting order:",t)}))},updateLessonSpaces(t,e=!1){if(!e)return Promise.resolve();const r=t.map((t=>fetch(`https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/lessons/${t.lessonId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({numberToDecrease:t.quantity})}).then((t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}))));return Promise.all(r).then((()=>{this.fetchLessons()})).catch((t=>{console.error("Error updating lessons:",t)}))},canAddToCart(t){let e=this.cart.find((e=>e.id===t.id)),r=e?e.quantity:0;return t.availableInventory>r},addItemCart(t){if(t.availableInventory<=0)return void alert("This lesson is fully booked.");t.availableInventory--;let e=this.cart.find((e=>e.id===t.id));e?e.quantity++:this.cart.push({...t,quantity:1})},updateSortOrder(t){this.sortOrder=t},removeItemCart(t){let e=this.cart.findIndex((e=>e.id===t.id));if(e>-1){let r=this.cart[e];r.quantity>1?r.quantity--:this.cart.splice(e,1);let o=this.products.find((e=>e.id===t.id));o&&o.availableInventory++}},toggleCart(){this.showProduct=!this.showProduct}},mounted(){this.fetchLessons()}};const W=(0,y.A)(x,[["render",l],["__scopeId","data-v-dad3a992"]]);var R=W,D={name:"App",components:{ParentComponent:R,LessonComponent:O,CheckoutComponent:$},data(){return{sitename:"👨‍🎓 STUDY SESSION STORE 👩‍🎓",showProduct:!0,products:[],cart:[],searchLesson:"",sortAttribute:"title",sortOrder:"ascending"}},computed:{cartItemCount(){return this.cart.reduce(((t,e)=>t+e.quantity),0)},sortedProducts(){let t=[...this.products].sort(((t,e)=>{let r=0;return t[this.sortAttribute]<e[this.sortAttribute]?r=-1:t[this.sortAttribute]>e[this.sortAttribute]&&(r=1),"ascending"===this.sortOrder?r:-1*r}));return t}},methods:{toggleCart(){this.showProduct=!this.showProduct},addItemToCart(t){let e=this.cart.find((e=>e.id===t.id));e?e.quantity+=1:this.cart.push({...t,quantity:1})},removeItemFromCart(t){const e=this.cart.findIndex((e=>e.id===t.id));-1!==e&&this.cart.splice(e,1)},fetchLessons(){fetch("https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/lessons").then((t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then((t=>{this.products=t})).catch((t=>{console.error("Error fetching lessons:",t)}))}},mounted(){this.fetchLessons()}};const J=(0,y.A)(D,[["render",a]]);var Q=J;const V=(0,o.Ef)(Q);V.mount("#app"),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js").then((t=>{console.log("SW registered: ",t)})).catch((t=>{console.log("SW registration failed: ",t)}))}))}},e={};function r(o){var s=e[o];if(void 0!==s)return s.exports;var n=e[o]={exports:{}};return t[o].call(n.exports,n,n.exports,r),n.exports}r.m=t,function(){var t=[];r.O=function(e,o,s,n){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],s=t[l][1],n=t[l][2];for(var i=!0,c=0;c<o.length;c++)(!1&n||a>=n)&&Object.keys(r.O).every((function(t){return r.O[t](o[c])}))?o.splice(c--,1):(i=!1,n<a&&(a=n));if(i){t.splice(l--,1);var u=s();void 0!==u&&(e=u)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[o,s,n]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,o){var s,n,a=o[0],i=o[1],c=o[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(c)var l=c(r)}for(e&&e(o);u<a.length;u++)n=a[u],r.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return r.O(l)},o=self["webpackChunkwebappcw1"]=self["webpackChunkwebappcw1"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(6490)}));o=r.O(o)})();
//# sourceMappingURL=app.551de67d.js.map