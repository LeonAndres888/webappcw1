(function(){"use strict";var t={6664:function(t,e,r){var o=r(5130),n=r(6768);const s={id:"app"};function a(t,e,r,o,a,i){const c=(0,n.g2)("parent-component"),u=(0,n.g2)("lesson-component"),l=(0,n.g2)("checkout-component");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.bF)(c,{sitename:a.sitename,cartItemCount:i.cartItemCount,onToggleCart:i.toggleCart},null,8,["sitename","cartItemCount","onToggleCart"]),a.showProduct?((0,n.uX)(),(0,n.Wv)(u,{key:0,lessons:i.sortedProducts,onAddToCart:i.addItemToCart},null,8,["lessons","onAddToCart"])):((0,n.uX)(),(0,n.Wv)(l,{key:1,cart:a.cart,onRemoveFromCart:i.removeItemFromCart},null,8,["cart","onRemoveFromCart"]))])}r(4114);var i=r(4232);const c={id:"app"},u={id:"titlename"};function l(t,e,r,o,s,a){const l=(0,n.g2)("lesson-component"),d=(0,n.g2)("checkout-component");return(0,n.uX)(),(0,n.CE)("div",c,[(0,n.Lk)("header",null,[(0,n.Lk)("h1",u,(0,i.v_)(s.sitename),1),(0,n.Lk)("button",{id:"cartBtn",onClick:e[0]||(e[0]=(...t)=>a.toggleCart&&a.toggleCart(...t))}," 🛒 Cart ("+(0,i.v_)(a.cartItemCount)+") ",1)]),(0,n.Lk)("main",null,[s.showProduct?((0,n.uX)(),(0,n.Wv)(l,{key:0,products:s.products,onAddItemToCart:a.addItemCart},null,8,["products","onAddItemToCart"])):((0,n.uX)(),(0,n.Wv)(d,{key:1,cart:s.cart,onRemoveItemFromCart:a.removeItemCart,validCheckout:a.validCheckout,orderSubmitted:s.orderSubmitted,onSubmitOrder:a.submitOrder},null,8,["cart","onRemoveItemFromCart","validCheckout","orderSubmitted","onSubmitOrder"]))])])}const d=t=>((0,n.Qi)("data-v-cab06372"),t=t(),(0,n.jt)(),t),h=["value"],p=["value"],m=d((()=>(0,n.Lk)("option",{value:"title"},"Subject",-1))),v=d((()=>(0,n.Lk)("option",{value:"location"},"Location",-1))),f=d((()=>(0,n.Lk)("option",{value:"price"},"Price",-1))),b=d((()=>(0,n.Lk)("option",{value:"availableInventory"},"Spaces",-1))),k=[m,v,f,b],C=["src","alt"],g=["onClick","disabled"],y={key:0,class:"sold-out"};function L(t,e,r,o,s,a){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("input",{type:"text",value:r.searchLesson,onInput:e[0]||(e[0]=e=>t.$emit("update:searchLesson",e.target.value)),placeholder:"Search lessons...",class:"search-bar"},null,40,h),(0,n.Lk)("select",{value:r.sortAttribute,onChange:e[1]||(e[1]=e=>t.$emit("update:sortAttribute",e.target.value)),class:"drop-down"},k,40,p),(0,n.Lk)("button",{onClick:e[2]||(e[2]=e=>t.$emit("update-sort-order","ascending")),class:"asc-button"}," Ascending "),(0,n.Lk)("button",{onClick:e[3]||(e[3]=e=>t.$emit("update-sort-order","descending")),class:"dsc-button"}," Descending "),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.sortedProducts,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"product-card"},[(0,n.Lk)("figure",null,[(0,n.Lk)("img",{src:e.image,alt:e.title},null,8,C)]),(0,n.Lk)("h2",null,(0,i.v_)(e.title),1),(0,n.Lk)("p",null,"Location: "+(0,i.v_)(e.location),1),(0,n.Lk)("p",null,"Price: £"+(0,i.v_)(e.price),1),(0,n.Lk)("p",null,"Spaces: "+(0,i.v_)(e.availableInventory),1),(0,n.Lk)("button",{onClick:r=>t.$emit("add-item-to-cart",e),disabled:0===e.availableInventory}," Add to Cart ",8,g),0===e.availableInventory?((0,n.uX)(),(0,n.CE)("p",y,"Sold Out")):(0,n.Q3)("",!0)])))),128))])}var I={props:["products","searchLesson","sortAttribute","sortOrder"],computed:{filteredProducts(){let t=this.searchLesson.trim().toLowerCase();return this.products.filter((e=>e.title.toLowerCase().includes(t)||e.location.toLowerCase().includes(t)))},sortedProducts(){let t="ascending"===this.sortOrder?1:-1;return this.filteredProducts.slice().sort(((e,r)=>"price"===this.sortAttribute||"availableInventory"===this.sortAttribute?(e[this.sortAttribute]-r[this.sortAttribute])*t:e[this.sortAttribute].localeCompare(r[this.sortAttribute])*t))}}},w=r(1241);const O=(0,w.A)(I,[["render",L],["__scopeId","data-v-cab06372"]]);var S=O;const P=t=>((0,n.Qi)("data-v-016c0271"),t=t(),(0,n.jt)(),t),A={class:"checkout-container"},E=P((()=>(0,n.Lk)("h1",null,"Shopping Cart",-1))),T={key:0},_={class:"cart-list"},j=["onClick"],X=["disabled"],q={key:0,class:"thank-you-message"},N={key:1,class:"empty-cart-message"};function $(t,e,r,s,a,c){return(0,n.uX)(),(0,n.CE)("div",A,[E,r.cart.length>0?((0,n.uX)(),(0,n.CE)("div",T,[(0,n.Lk)("ul",_,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.cart,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e.id,class:"cart-item"},[(0,n.Lk)("span",null,(0,i.v_)(e.title)+" - "+(0,i.v_)(e.location)+" - £"+(0,i.v_)(e.price),1),(0,n.Lk)("button",{class:"remove-btn",onClick:r=>t.$emit("remove-item",e)}," Remove ",8,j)])))),128))]),(0,n.Lk)("form",{class:"checkout-form",onSubmit:e[2]||(e[2]=(0,o.D$)(((...t)=>c.checkOut&&c.checkOut(...t)),["prevent"]))},[(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>a.custName=t),placeholder:"Name",required:""},null,512),[[o.Jo,a.custName]]),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>a.custPhone=t),placeholder:"Phone number",required:""},null,512),[[o.Jo,a.custPhone]]),(0,n.Lk)("button",{type:"submit",class:"checkout-btn",disabled:!r.validCheckout}," Checkout ",8,X)],32),r.orderSubmitted?((0,n.uX)(),(0,n.CE)("p",q," Thank you for your order! ")):(0,n.Q3)("",!0)])):((0,n.uX)(),(0,n.CE)("div",N,"Your cart is empty."))])}var x={props:{cart:Array,validCheckout:Boolean,orderSubmitted:Boolean},data(){return{custName:"",custPhone:""}},methods:{checkOut(){this.$emit("submit-order",{name:this.custName,phone:this.custPhone})}}};const F=(0,w.A)(x,[["render",$],["__scopeId","data-v-016c0271"]]);var W=F,R={components:{LessonComponent:S,CheckoutComponent:W},data(){return{sitename:"👨‍🎓 STUDY SESSION STORE 👩‍🎓",showProduct:!0,products:[],cart:[],searchLesson:"",sortAttribute:"title",sortOrder:"",custName:"",custPhone:"",orderSubmitted:!1}},computed:{cartItemCount(){return this.cart.reduce(((t,e)=>t+e.quantity),0)},validCheckout(){const t=/^[A-Za-z\s]+$/,e=/^[0-9()-]+$/;return t.test(this.custName)&&e.test(this.custPhone)}},methods:{fetchLessons(){fetch("https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/lessons").then((t=>t.json())).then((t=>{this.products=t})).catch((t=>{console.error("Error fetching lessons:",t)}))},submitOrder(){const t={name:this.custName,phoneNumber:this.custPhone,items:this.cart.map((t=>({lessonId:t._id,quantity:t.quantity})))};console.log("Order items before submitting:",t.items),fetch("https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})).then((e=>(this.orderSubmitted=!0,console.log("Order submitted:",e),this.updateLessonSpaces(t.items,!0)))).then((()=>{this.fetchLessons()})).catch((t=>{console.error("Error submitting order:",t)}))},updateLessonSpaces(t,e=!1){if(!e)return Promise.resolve();const r=t.map((t=>fetch(`https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/lessons/${t.lessonId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({numberToDecrease:t.quantity})}).then((t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}))));return Promise.all(r).then((()=>{this.fetchLessons()})).catch((t=>{console.error("Error updating lessons:",t)}))},canAddToCart(t){let e=this.cart.find((e=>e.id===t.id)),r=e?e.quantity:0;return t.availableInventory>r},addItemCart(t){if(t.availableInventory<=0)return void alert("This lesson is fully booked.");t.availableInventory--;let e=this.cart.find((e=>e.id===t.id));e?e.quantity++:this.cart.push({...t,quantity:1})},updateSortOrder(t){this.sortOrder=t},removeItemCart(t){let e=this.cart.findIndex((e=>e.id===t.id));if(e>-1){let r=this.cart[e];r.quantity>1?r.quantity--:this.cart.splice(e,1);let o=this.products.find((e=>e.id===t.id));o&&o.availableInventory++}},toggleCart(){this.showProduct=!this.showProduct}},mounted(){this.fetchLessons()}};const D=(0,w.A)(R,[["render",l],["__scopeId","data-v-01d326c8"]]);var U=D,J={name:"App",components:{ParentComponent:U,LessonComponent:S,CheckoutComponent:W},data(){return{sitename:"👨‍🎓 STUDY SESSION STORE 👩‍🎓",showProduct:!0,products:[],cart:[],searchLesson:"",sortAttribute:"title",sortOrder:"ascending"}},computed:{cartItemCount(){return this.cart.reduce(((t,e)=>t+e.quantity),0)},sortedProducts(){let t=[...this.products].sort(((t,e)=>{let r=0;return t[this.sortAttribute]<e[this.sortAttribute]?r=-1:t[this.sortAttribute]>e[this.sortAttribute]&&(r=1),"ascending"===this.sortOrder?r:-1*r}));return t}},methods:{toggleCart(){this.showProduct=!this.showProduct},addItemToCart(t){let e=this.cart.find((e=>e.id===t.id));e?e.quantity+=1:this.cart.push({...t,quantity:1})},removeItemFromCart(t){const e=this.cart.findIndex((e=>e.id===t.id));-1!==e&&this.cart.splice(e,1)},fetchLessons(){fetch("https://storefinal-env.eba-vfsgptpf.us-east-1.elasticbeanstalk.com/api/lessons").then((t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then((t=>{this.products=t})).catch((t=>{console.error("Error fetching lessons:",t)}))}},mounted(){this.fetchLessons()}};const Q=(0,w.A)(J,[["render",a]]);var B=Q;const Y=(0,o.Ef)(B);Y.mount("#app"),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js").then((t=>{console.log("SW registered: ",t)})).catch((t=>{console.log("SW registration failed: ",t)}))}))}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,r),s.exports}r.m=t,function(){var t=[];r.O=function(e,o,n,s){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],n=t[l][1],s=t[l][2];for(var i=!0,c=0;c<o.length;c++)(!1&s||a>=s)&&Object.keys(r.O).every((function(t){return r.O[t](o[c])}))?o.splice(c--,1):(i=!1,s<a&&(a=s));if(i){t.splice(l--,1);var u=n();void 0!==u&&(e=u)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[o,n,s]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,o){var n,s,a=o[0],i=o[1],c=o[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(c)var l=c(r)}for(e&&e(o);u<a.length;u++)s=a[u],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(l)},o=self["webpackChunkwebappcw1"]=self["webpackChunkwebappcw1"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(6664)}));o=r.O(o)})();
//# sourceMappingURL=app.b295d0a5.js.map